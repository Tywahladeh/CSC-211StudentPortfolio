window.__cvg_pixel = {"integration_config": {"ga4_measurement_ids": [{"measurement_id": "G-Z9ZWYD5HKR", "internal_converge_data_layer": false}, {"measurement_id": "G-961FEV0JLE", "internal_converge_data_layer": false}], "enable_criteo": false, "taboola_click_id_parameters": []}, "connections": [{"config": {"app": "ga4", "measurement_id": "G-Z9ZWYD5HKR", "item_id_type": "sku", "connection_type": "server", "user_properties": [], "ga4_event_properties": [], "ga4_item_properties": [], "custom_ga4_events": [], "internal_converge_data_layer": false, "use_converge_hosted_script": false, "set_user_id": false}, "connection_id": 3245}, {"config": {"app": "ga4", "measurement_id": "G-961FEV0JLE", "item_id_type": "sku", "connection_type": "server", "user_properties": [], "ga4_event_properties": [], "ga4_item_properties": [], "custom_ga4_events": [], "internal_converge_data_layer": false, "use_converge_hosted_script": false, "set_user_id": false}, "connection_id": 3232}, {"config": {"app": "google_ads", "tag_id": "AW-997209061", "item_id_type": "product_id", "custom_google_ads_events": [], "conversions": [], "internal_converge_data_layer": false}, "connection_id": 7583}, {"config": {"app": "tiktok", "pixel_code": "C8KDMLKO0T91FSTH2LQ0", "content_id_type": "sku"}, "connection_id": 3270}, {"config": {"app": "pinterest", "tag_id": "2613139130107", "pinterest_content_id_type": "sku"}, "connection_id": 3248}, {"config": {"app": "fb", "pixel_id": "1157926667999694", "content_id_type": "sku", "custom_events": [], "fb_custom_properties": [], "send_subscribed_to_newsletter_as_leads": true, "block_external_tracking": false}, "connection_id": 3203}], "custom_events": null, "public_token": "vg5Jy6"};
!function(t){"use strict";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}var r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)};function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}var n=function(){return n=Object.assign||function(t){for(var e,r=1,i=arguments.length;r<i;r++)for(var n in e=arguments[r])Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t},n.apply(this,arguments)};function o(t,e,r,i){return new(r||(r=Promise))((function(n,o){function s(t){try{c(i.next(t))}catch(t){o(t)}}function a(t){try{c(i.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,a)}c((i=i.apply(t,e||[])).next())}))}function s(t,e){var r,i,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(a){return function(c){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,a[0]&&(s=0)),s;)try{if(r=1,i&&(n=2&a[0]?i.return:a[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,a[1])).done)return n;switch(i=0,n&&(a=[2&a[0],n.value]),a[0]){case 0:case 1:n=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(n=s.trys,(n=n.length>0&&n[n.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!n||a[1]>n[0]&&a[1]<n[3])){s.label=a[1];break}if(6===a[0]&&s.label<n[1]){s.label=n[1],n=a;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(a);break}n[2]&&s.ops.pop(),s.trys.pop();continue}a=e.call(t,s)}catch(t){a=[6,t],i=0}finally{r=n=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}function a(t){var e="function"==typeof Symbol&&Symbol.iterator,r=e&&t[e],i=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function c(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var i,n,o=r.call(t),s=[];try{for(;(void 0===e||e-- >0)&&!(i=o.next()).done;)s.push(i.value)}catch(t){n={error:t}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return s}function u(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))}"function"==typeof SuppressedError&&SuppressedError;var d,p=function(t){var e=this;this.detectBot=function(){return!!e.browser.navigator.userAgent.toLowerCase().match(/bot|crawler|spider|robot|crawling|facebookexternalhit|remotasks/)},this.detectInternalUser=function(){return o(e,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return new URLSearchParams(window.location.search).get("internalUser")?[4,this.browser.setCookie("__cvg_internal_user","1",1051200)]:[3,2];case 1:case 4:return t.sent(),[2,!0];case 2:return[4,this.browser.getCookie("__cvg_internal_user")];case 3:return t.sent()?[4,this.browser.setCookie("__cvg_internal_user","1",1051200)]:[3,5];case 5:return[2,!1]}}))}))},this.getURLParameterByName=function(t){t=t.replace(/[\[\]]/g,"\\$&");var r=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)","i").exec(e.browser.window.location.href);return r?r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):"":null},this.guid=function(){return"xxxxxxxx-".replace(/[x]/g,(function(t){var e=36*Math.random()|0;return("x"==t?e:3&e|8).toString(36)}))+(new Date).getTime().toString(36)},this.UID_COOKIE="__cvg_uid",this.setUid=function(){return o(e,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.browser.getCookie(this.UID_COOKIE)];case 1:return t=e.sent()||this.getURLParameterByName(this.UID_COOKIE)||this.guid(),[4,this.browser.setCookie(this.UID_COOKIE,t,1051200)];case 2:return e.sent(),[2,t]}}))}))},this.isMobile=function(){return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e.browser.navigator.userAgent)},this.addScript=function(t,e){var r=e||{},i=r.id,n=r.sync,o=r.onLoad;if("undefined"!=typeof document){if(i){var s=document.getElementById(i);if(s)return s}if(!(null==e?void 0:e.allowDuplicateSrc))for(var a=document.getElementsByTagName("script"),c=0;c<a.length;c++)if(a[c].src===t)return a[c];var u=document.createElement("script");u.async=!n,u.src=t,i&&(u.id=i),o&&(u.onload=o);var d=document.getElementsByTagName("script")[0];return d&&d.parentNode?d.parentNode.insertBefore(u,d):document.head.appendChild(u),u}},this.browser=t},h=function(){function t(t,e){this.pixel=t,this.utils=t.utils,this.browser=t.browser,this.logger=t.logger,this.config=e}return t.create=function(t,e){return new this(t,e)},t.prototype.setup=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return[2]}))}))},t}(),l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.create=function(t,e){if(e.enable_criteo)return new this(t,e)},e.prototype.setupGum=function(){var t=this;"undefined"!=typeof window&&"undefined"!=typeof document&&window.addEventListener("load",(function(){window.__cvg_criteo_gum_func=function(e){var r=e.userid;r&&(t.pixel.setProperty("$criteo_id",r),t.pixel.track({method:"track",eventName:"$identify",profileProperties:{$criteo_id:r}}))};var e=document.createElement("script");e.src="https://gum.criteo.com/sync?c=".concat("644","&a=1&r=2&j=__cvg_criteo_gum_func"),document.body.appendChild(e)}))},e.prototype.setup=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){return this.setupGum(),[2]}))}))},e}(h),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t,e,r;return s(this,(function(i){switch(i.label){case 0:return[4,this.browser.getCookie("_fbp")];case 1:return(t=i.sent())?[3,3]:(t="fb.1.".concat((new Date).getTime(),".").concat(Math.floor(1e8+9e8*Math.random())),[4,this.browser.setCookie("_fbp",t,1051200)]);case 2:i.sent(),i.label=3;case 3:return this.pixel.setProperty("$fbp",t),[4,this.browser.getCookie("_fbc")];case 4:return(e=i.sent())?[3,6]:(r=this.utils.getURLParameterByName("fbclid")||"")?(e="fb.1.".concat((new Date).getTime(),".").concat(r),[4,this.browser.setCookie("_fbc",e,1051200)]):[3,6];case 5:i.sent(),i.label=6;case 6:return e&&this.pixel.setProperty("$fbc",e),[2]}}))}))},e}(h),v="_cvgInternalDataLayer",m=function(t){function e(e,r){var i,n=t.call(this,e,r)||this;return n.measurementIds=null===(i=r.ga4_measurement_ids)||void 0===i?void 0:i.map((function(t){return"string"==typeof t?{measurement_id:t}:t})),n}return i(e,t),e.prototype.gtag=function(){"undefined"!=typeof window&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push(arguments))},e.prototype.gtagInternal=function(){"undefined"!=typeof window&&(window[v]=window[v]||[],window[v].push(arguments))},e.prototype.gtagGet=function(t,e,r){return void 0===r&&(r=2e3),o(this,void 0,void 0,(function(){var i=this;return s(this,(function(n){switch(n.label){case 0:return[4,new Promise((function(n){var o=setTimeout((function(){i.logger.warn("Timed out waiting for ".concat(e," for ").concat(t)),n(void 0)}),r);(t.internal_converge_data_layer?i.gtagInternal:i.gtag)("get",t.measurement_id,e,(function(t){clearTimeout(o),n(t)}))}))];case 1:return[2,n.sent()]}}))}))},e.prototype.getSession=function(t){return o(this,void 0,void 0,(function(){var e,r,i,n;return s(this,(function(o){switch(o.label){case 0:return e=t.measurement_id.slice(2),[4,Promise.all([this.gtagGet(t,"session_id"),this.gtagGet(t,"session_number")])];case 1:return r=c.apply(void 0,[o.sent(),2]),i=r[0],n=r[1],[2,{id:e,sessionId:i,sessionNumber:n}]}}))}))},e.prototype.getClientId=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.gtagGet(t,"client_id")];case 1:return[2,e.sent()]}}))}))},e.prototype.byCookies=function(){var t,e,r,i;return o(this,void 0,void 0,(function(){var n,o,a,c,u,d,p;return s(this,(function(s){for(n=/(^| )_ga_([A-Z0-9]+)=([^;]+)/g;null!==(o=n.exec(document.cookie));)a=o[2],c=o[3],u=c.split(".")[2],d=c.split(".")[3],u&&d&&(this.pixel.setProperty("$ga4_session_id_".concat(a),u),this.pixel.setProperty("$ga4_session_number_".concat(a),d));return(p=null===(i=null===(r=null===(e=null===(t=document.cookie.match(/_ga=([^;]+)/))||void 0===t?void 0:t[1])||void 0===e?void 0:e.split("."))||void 0===r?void 0:r.slice(2))||void 0===i?void 0:i.join("."))&&this.pixel.setProperty("$ga4_client_id",p),[2]}))}))},e.prototype.byGtag=function(){return o(this,void 0,void 0,(function(){var t,e,r,i,n,o,c,u,d,p,h,l,f=this;return s(this,(function(s){switch(s.label){case 0:if(!this.measurementIds||!this.measurementIds.length)return[2];try{for(t=a(this.measurementIds||[]),e=t.next();!e.done;e=t.next())(r=e.value).internal_converge_data_layer?this.gtagInternal("event","cvg_loaded_",{send_to:r.measurement_id}):this.gtag("event","cvg_loaded_",{send_to:r.measurement_id})}catch(t){d={error:t}}finally{try{e&&!e.done&&(p=t.return)&&p.call(t)}finally{if(d)throw d.error}}return[4,this.getClientId(this.measurementIds[0])];case 1:return(i=s.sent())&&this.pixel.setProperty("$ga4_client_id",i),[4,Promise.all(this.measurementIds.map((function(t){return f.getSession(t)})))];case 2:n=s.sent();try{for(o=a(n),c=o.next();!c.done;c=o.next())(u=c.value).sessionId&&u.sessionNumber&&(this.pixel.setProperty("$ga4_session_id_".concat(u.id),u.sessionId),this.pixel.setProperty("$ga4_session_number_".concat(u.id),u.sessionNumber))}catch(t){h={error:t}}finally{try{c&&!c.done&&(l=o.return)&&l.call(o)}finally{if(h)throw h.error}}return[2]}}))}))},e.prototype.setup=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return"undefined"==typeof window?[2]:[4,this.byCookies()];case 1:return t.sent(),[4,this.byGtag()];case 2:return t.sent(),[2]}}))}))},e}(h),y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.getKxFromCookie=function(){return o(this,void 0,void 0,(function(){var t,e,r;return s(this,(function(i){switch(i.label){case 0:return[4,this.browser.getCookie("__kla_id")];case 1:t=i.sent();try{return 0===(e=atob(t)).length?[2,!1]:[2,null==(r=JSON.parse(e))?void 0:r.$exchange_id]}catch(t){this.logger.error("Could not decode klaID",t)}return[2]}}))}))},e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(r){switch(r.label){case 0:return(t=this.utils.getURLParameterByName("_kx"))&&""!==t?[3,2]:[4,this.getKxFromCookie()];case 1:t=r.sent(),r.label=2;case 2:return t&&t.length>0&&this.pixel.setProperty("$klaviyo_exchange_id",t),window.addEventListener("klaviyoForms",(function(t){var r,i,o,s,a,c,u,d,p,h,l,f,v,m,y,g,_,w=t;"submit"==(null===(r=w.detail)||void 0===r?void 0:r.type)&&((null===(o=null===(i=w.detail)||void 0===i?void 0:i.metaData)||void 0===o?void 0:o.$email)&&e.pixel.addAlias("urn:email:".concat(null===(s=w.detail.metaData)||void 0===s?void 0:s.$email)),e.pixel.track({method:"track",eventName:"Subscribed To Newsletter",profileProperties:{$email:null===(c=null===(a=w.detail)||void 0===a?void 0:a.metaData)||void 0===c?void 0:c.$email,$first_name:null===(d=null===(u=w.detail)||void 0===u?void 0:u.metaData)||void 0===d?void 0:d.$first_name,$last_name:null===(h=null===(p=w.detail)||void 0===p?void 0:p.metaData)||void 0===h?void 0:h.$last_name,$phone_number:null===(f=null===(l=w.detail)||void 0===l?void 0:l.metaData)||void 0===f?void 0:f.$phone_number},properties:n({form:null===(m=null===(v=w.detail)||void 0===v?void 0:v.metaData)||void 0===m?void 0:m.$source,formId:null===(y=w.detail)||void 0===y?void 0:y.formId,companyId:null===(g=w.detail)||void 0===g?void 0:g.companyId},null===(_=w.detail)||void 0===_?void 0:_.metaData)}))})),[2]}}))}))},e}(h),g=function(t){return"urn:email:".concat(t)},_=function(t,e){return e&&"urn:shopify:".concat(e,":customer_id:").concat(t)},w=function(t){function e(e,r,i){var n=t.call(this,e,r)||this;return n.shopName=i,n}return i(e,t),e.create=function(t,r){var i,n=r.shop_name;if(!n&&"undefined"!=typeof window){var o=null===(i=window.Shopify)||void 0===i?void 0:i.shop;o&&(n=o.split(".")[0])}if(n)return new e(t,r,n)},e.prototype.parseLineItemCustom=function(t){return{product_id:t.variant.product.id.toString(),variant_id:t.variant.id.toString(),name:t.variant.product.title,price:t.variant.price.amount,sku:t.variant.sku,variant_name:t.variant.title,currency:t.variant.price.currencyCode,vendor:t.variant.product.vendor,quantity:t.quantity}},e.prototype.parseCheckoutCompletedCustom=function(t){var e,r,i,n,o=t.checkout;return{id:o.token,items:u([],c(null===(e=o.lineItems)||void 0===e?void 0:e.map(this.parseLineItemCustom)),!1),total_price:o.totalPrice.amount,total_tax:o.totalTax.amount,total_shipping:(null===(i=null===(r=o.shippingLine)||void 0===r?void 0:r.price)||void 0===i?void 0:i.amount)||(null===(n=o.shippingPrice)||void 0===n?void 0:n.amount),currency:o.totalPrice.currencyCode}},e.prototype.parseCheckoutStartedCustom=function(t){return this.parseCheckoutCompletedCustom(t)},e.prototype.parseCollectionViewedCustom=function(t){var e=t.collection;return{id:e.id,name:e.title,items:[]}},e.prototype.parsePaymentInfoSubmittedCustom=function(t){return this.parseCheckoutCompletedCustom(t)},e.prototype.parseProductedAddedToCartCustom=function(t){var e=t.cartLine,r=e.merchandise;return{product_id:r.product.id.toString(),variant_id:r.id.toString(),name:r.product.title,price:e.cost.totalAmount.amount,sku:r.sku,variant_name:r.title,currency:e.cost.totalAmount.currencyCode,vendor:r.product.vendor,quantity:e.quantity}},e.prototype.parseProductViewedCustom=function(t){var e=t.productVariant;return{product_id:e.product.id.toString(),variant_id:e.id.toString(),name:e.product.title,price:e.price.amount,sku:e.sku,variant_name:e.title,currency:e.price.currencyCode,vendor:e.product.vendor}},e.prototype.parseSearchSubmittedCustom=function(t){return{query:t.searchResult.query}},e.prototype.parseViewedProduct=function(t){var e=t.variant,r=t.currency,i=t.product;return{product_id:i.id.toString(),variant_id:e.id,name:i.title,price:e.price/100,sku:e.sku,variant_name:e.title,currency:r,vendor:i.vendor}},e.prototype.parseViewedCollection=function(t){var e,r,i=t.collection,n=t.currency,o=[];try{for(var s=a(i.products),c=s.next();!c.done;c=s.next()){var u=c.value,d=u.variants[0];d&&o.push({product_id:u.id.toString(),variant_id:d.id.toString(),sku:d.sku,name:u.title,variant_name:d.title,price:d.price/100,currency:n,vendor:u.vendor})}}catch(t){e={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(e)throw e.error}}return{id:i.id,name:i.title,description:i.description,items:o.slice(0,20)}},e.prototype.parseSearched=function(t){return{query:t.search}},e.prototype.initCustomer=function(){var t,e,r;if("undefined"!=typeof window){var i=null===(r=null===(e=null===(t=window.shopify)||void 0===t?void 0:t.init)||void 0===e?void 0:e.data)||void 0===r?void 0:r.customer;if(i){var n=i.email;n&&(this.pixel.addAlias(g(n)),this.pixel.setProperty("$email",n));var o=i.id;o&&(this.pixel.addAlias(_(o,this.shopName)),this.pixel.setProperty("$customer_id",o));var s=i.phone;s&&this.pixel.setProperty("$phone_number",s)}}},e.prototype.trackLoggedIn=function(t){return o(this,void 0,void 0,(function(){var e,r,i,n;return s(this,(function(o){switch(o.label){case 0:return e="__cvg_shopify_logged_in",r=34560,t?[3,2]:[4,this.browser.getCookie(e)];case 1:return[2,o.sent()];case 2:return i=t.toString(),[4,this.browser.getCookie(e)];case 3:return n=o.sent(),[4,this.browser.setCookie(e,i,r)];case 4:return o.sent(),i!==n&&this.pixel.track({method:"track",eventName:"Logged In"}),[2,i]}}))}))},e.prototype.getCheckoutTokens=function(){var t,e;return o(this,void 0,void 0,(function(){var r,i;return s(this,(function(n){switch(n.label){case 0:return[4,this.browser.getCookie("checkout_session_lookup")];case 1:if(!(r=n.sent()))return[2,[]];try{return(i=JSON.parse(decodeURIComponent(r)))&&i.keys?[2,u(u([],c(null===(t=i.keys)||void 0===t?void 0:t.map((function(t){return t.source_id}))),!1),c(null===(e=i.keys)||void 0===e?void 0:e.map((function(t){return t.checkout_session_identifier}))),!1).filter((function(t){return!!t}))]:[2,[]]}catch(t){return this.logger.error("Failed to parse checkout_session_lookup cookie",t),[2,[]]}return[2]}}))}))},e.prototype.onWebPixelEvent=function(t){var e,r,i,a,d,p,h,l,f,v,m,y,_,w,k,b,I;return o(this,void 0,void 0,(function(){var o,C,P,x,E,T,S,N,q,A,$,D,O,L,U,V,j,R,M,F,G,B;return s(this,(function(s){switch(s.label){case 0:return o=[],C={},"payment_info_submitted"!==t.name&&"checkout_completed"!=t.name||(P=(null===(e=t.data.checkout)||void 0===e?void 0:e.email)||void 0,x=(null===(r=t.data.checkout)||void 0===r?void 0:r.phone)||(null===(a=null===(i=t.data.checkout)||void 0===i?void 0:i.shippingAddress)||void 0===a?void 0:a.phone)||void 0,E=(null===(p=null===(d=t.data.checkout)||void 0===d?void 0:d.shippingAddress)||void 0===p?void 0:p.city)||void 0,T=(null===(l=null===(h=t.data.checkout)||void 0===h?void 0:h.shippingAddress)||void 0===l?void 0:l.countryCode)||void 0,S=(null===(v=null===(f=t.data.checkout)||void 0===f?void 0:f.shippingAddress)||void 0===v?void 0:v.province)||void 0,N=(null===(y=null===(m=t.data.checkout)||void 0===m?void 0:m.shippingAddress)||void 0===y?void 0:y.zipCode)||void 0,q=(null===(_=t.data.checkout)||void 0===_?void 0:_.token)||void 0,A={$email:P,$phone_number:x,$city:E,$country_code:T,$state:S,$zip_code:N},P&&(o.push(g(P)),C=n(n({},C),A)),q&&o.push("urn:shopify:checkout_token:".concat(q))),$=null,D=null,O=null,"checkout_completed"!==t.name?[3,1]:(D=t.name,$=this.parseCheckoutCompletedCustom(t.data),(L=null===(k=null===(w=t.data.checkout)||void 0===w?void 0:w.order)||void 0===k?void 0:k.id)&&L.startsWith("gid://shopify")&&(L=L.split("/").pop()),U=L?(z=L,(H=this.shopName)&&"urn:shopify:".concat(H,":order_id:").concat(z)):null,L&&U&&o.push(U),this.pixel.forward({method:"forward",eventName:"Placed Order",properties:$,profileProperties:C,eventID:L}),[3,8]);case 1:return"checkout_started"!==t.name?[3,2]:(D="Started Checkout",$=this.parseCheckoutStartedCustom(t.data),[3,8]);case 2:return"payment_info_submitted"!==t.name?[3,3]:(D="Added Payment Info",$=this.parsePaymentInfoSubmittedCustom(t.data),[3,8]);case 3:return"product_added_to_cart"!==t.name?[3,5]:(D="Added To Cart",[4,this.atcRecordId(t.timestamp,t.data.cartLine.merchandise.id)]);case 4:return O=s.sent(),$=this.parseProductedAddedToCartCustom(t.data),[3,8];case 5:return"page_viewed"===t.name&&/.*\/checkouts\/.*/.test(t.context.document.location.pathname)?(K=t.context.document.location.pathname,V=K.substring(K.lastIndexOf("/")+1),j=new URLSearchParams(t.context.document.location.search).get("step"),R=j||V,(M="undefined"!=typeof window&&(null===(b=window.shopify)||void 0===b?void 0:b.init))&&M.data&&M.data.cart?(F=M.data.cart,$={items:u([],c(null===(I=F.lines)||void 0===I?void 0:I.map(this.parseLineItemCustom)),!1),total_price:F.cost.totalAmount.amount,currency:F.cost.totalAmount.currencyCode}):$={total_price:0},[4,this.browser.getCookie("__cvg_checkout_stage")]):[3,8];case 6:return G=+s.sent(),B=-1,"information"===R||"contact_information"===R?B=1:"shipping"===R||"shipping_method"===R?B=2:"payment"!==R&&"payment_method"!==R||(B=3),B>0?[4,this.browser.setCookie("__cvg_checkout_stage",B.toString())]:[3,8];case 7:if(s.sent(),B>(G||-1))switch(B){case 2:D="Added Contact Info";break;case 3:D="Added Shipping Info"}s.label=8;case 8:return $&&D&&this.pixel.track({method:"track",eventName:D,eventID:O||t.id,properties:n(n({},$),{clientId:t.clientId,eventId:t.id}),profileProperties:C,aliases:o}),[2]}var K,z,H}))}))},e.prototype.getCartToken=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.browser.getCookie("cart")];case 1:return[2,t.sent()]}}))}))},e.prototype.setupCartTokenRefresh=function(){return o(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(r){switch(r.label){case 0:return"undefined"==typeof window?[2]:[4,this.getCartToken()];case 1:return t=r.sent(),window.addEventListener("cookiechanged",(function(){return o(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return[4,this.getCartToken()];case 1:return(e=r.sent())&&e!==t&&this.pixel.track({method:"track",eventName:"$identify",aliases:["urn:shopify:cart_token:".concat(e)]}),t=e,[2]}}))}))})),[2]}}))}))},e.prototype.getShopifyYCookie=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:return[4,this.browser.getCookie("_shopify_y")];case 1:return t=r.sent(),[4,this.browser.getCookie("_y")];case 2:return e=r.sent(),[2,t||e]}}))}))},e.prototype.atcRecordId=function(t,e){return o(this,void 0,void 0,(function(){var r,i;return s(this,(function(n){switch(n.label){case 0:return r=t.slice(0,t.length-7)+"00",[4,this.getCartToken()];case 1:return i=n.sent(),[2,"".concat(r,":").concat(i,":").concat(e)]}}))}))},e.prototype.setup=function(){var t;return o(this,void 0,void 0,(function(){var e,r,i,n,o,a,c=this;return s(this,(function(s){switch(s.label){case 0:return[4,this.getCartToken()];case 1:return(e=s.sent())?(this.pixel.addAlias("urn:shopify:cart_token:".concat(e)),[3,4]):[3,2];case 2:return[4,this.setupCartTokenRefresh()];case 3:s.sent(),s.label=4;case 4:return[4,this.getShopifyYCookie()];case 5:return(r=s.sent())&&this.pixel.addAlias("urn:shopify:shopify_y:".concat(r)),[4,this.getCheckoutTokens()];case 6:return s.sent().forEach((function(t){c.pixel.addAlias("urn:shopify:checkout_token:".concat(t))})),(i="undefined"!=typeof window&&window.__cvg_shopify_info)?[4,this.trackLoggedIn(i.customer_id)]:[3,8];case 7:(n=s.sent())&&n.length>0&&(this.pixel.addAlias(_(n,this.shopName)),this.pixel.setProperty("$customer_id",i.customer_id)),i.email&&(this.pixel.addAlias(g(i.email)),this.pixel.setProperty("$email",i.email)),!(o=i.phone)&&i.shipping_address&&i.shipping_address.phone&&(o=i.shipping_address.phone),o&&this.pixel.setProperty("$phone_number",o),i.address&&this.pixel.setProperties({$city:i.address.city,$country_code:i.address.country_code,$state:i.address.province,$zip_code:i.address.zip}),i.variant&&(a=this.parseViewedProduct(i),this.pixel.track({method:"track",eventName:"Viewed Product",properties:a})),i.collection&&i.collection.products&&i.collection.id&&(a=this.parseViewedCollection(i),this.pixel.track({method:"track",eventName:"Viewed Collection",properties:a})),i.search&&(a=this.parseSearched(i),this.pixel.track({method:"track",eventName:"Searched",properties:a})),s.label=8;case 8:return"undefined"!=typeof window&&(null===(t=window.shopify)||void 0===t?void 0:t.analytics)&&window.shopify.analytics.subscribe("all_events",this.onWebPixelEvent.bind(this)),this.initCustomer(),[2]}}))}))},e}(h),k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:return[4,this.browser.getCookie("_ttp")];case 1:return(t=r.sent())&&this.pixel.setProperty("$tiktok_ttp",t),[4,this.browser.getCookie("ttclid")];case 2:return(e=r.sent())?[3,4]:(e=this.utils.getURLParameterByName("ttclid")||"")?[4,this.browser.setCookie("ttclid",e,1051200)]:[3,4];case 3:r.sent(),r.label=4;case 4:return e&&this.pixel.setProperty("$tiktok_ttclid",e),[2]}}))}))},e}(h),b=function(t){function e(){var e=t.apply(this,u([],c(arguments),!1))||this;return e.UTM_COOKIE="__cvg_utm",e}return i(e,t),e.prototype.setUtms=function(){return o(this,void 0,void 0,(function(){var t,e,r,i,n,o,c,u,d,p;return s(this,(function(s){switch(s.label){case 0:t=["utm_source","utm_medium","utm_term","utm_content","utm_campaign","utm_source_platform","utm_creative_format","utm_marketing_tactic","cvg_source","cvg_adid","cvg_cid","tw_source","tw_adid","tw_campaign","fbadid","gadid","ttadid","scadid","padid"],e={};try{for(r=a(t),i=r.next();!i.done;i=r.next())n=i.value,(o=this.utils.getURLParameterByName(n))&&(e[n]=o)}catch(t){d={error:t}}finally{try{i&&!i.done&&(p=r.return)&&p.call(r)}finally{if(d)throw d.error}}return Object.keys(e).length>0?(c=encodeURIComponent(JSON.stringify(e)),[4,this.browser.setCookie(this.UTM_COOKIE,c)]):[3,2];case 1:return s.sent(),localStorage.setItem(this.UTM_COOKIE,c),[2,e];case 2:return[4,this.browser.getCookie(this.UTM_COOKIE)];case 3:return[2,(u=s.sent()||localStorage.getItem(this.UTM_COOKIE))?JSON.parse(decodeURIComponent(u)):{}]}}))}))},e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t,e;return s(this,(function(r){switch(r.label){case 0:return e=(t=this.pixel).setProperties,[4,this.setUtms()];case 1:return e.apply(t,[r.sent()]),[2]}}))}))},e}(h),I=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.detectAdBlocker=function(){if("undefined"!=typeof document){var t=document.createElement("div");if(t.className="ads ad adsbox doubleclick ad-placement carbon-ads",t.id="bottomAd",t.style.cssText="height: 1px; width: 1px; position: absolute; left: -999em; top: -999em",document.body){document.body.appendChild(t);var e=document.getElementById("bottomAd");if(!e)return!0;var r=getComputedStyle(e);return!r||"none"===r.display}return!1}},e.prototype.setup=function(){return o(this,void 0,void 0,(function(){return s(this,(function(t){try{this.pixel.setProperty("has_ad_blocker",this.detectAdBlocker())}catch(t){this.logger.error("Error detecting ad blocker",t)}return[2]}))}))},e}(h),C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.browser.getCookie("_epik")];case 1:return(t=e.sent())?[3,3]:(t=this.utils.getURLParameterByName("epik")||"")?[4,this.browser.setCookie("_epik",t,1051200)]:[3,3];case 2:e.sent(),e.label=3;case 3:return t&&this.pixel.setProperty("$pinterest_click_id",t),[2]}}))}))},e}(h),P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return(t=this.utils.getURLParameterByName("tblcid"))?[3,2]:[4,this.browser.getCookie("__cvg_tblcid")];case 1:t=e.sent(),e.label=2;case 2:return t&&(this.browser.setCookie("__cvg_tblcid",t,129600),this.pixel.setProperty("$taboola_click_id",t)),[2]}}))}))},e}(h),x=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return(t=this.utils.getURLParameterByName("outbraincid"))?[3,2]:[4,this.browser.getCookie("__cvg_outbraincid")];case 1:t=e.sent(),e.label=2;case 2:return t&&(this.browser.setCookie("__cvg_outbraincid",t,129600),this.pixel.setProperty("$outbrain_click_id",t)),[2]}}))}))},e}(h),E=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.setup=function(){return o(this,void 0,void 0,(function(){var t;return s(this,(function(e){switch(e.label){case 0:return[4,this.browser.getCookie("session_id")];case 1:return(t=e.sent())&&this.pixel.addAlias("urn:funnelish:session:".concat(t)),[2]}}))}))},e}(h),T="https://app.runconverge.com",S=function(){function t(){var t,e=this;this.getCookie=function(t){return o(e,void 0,void 0,(function(){var e,r,i,n;return s(this,(function(o){switch(o.label){case 0:return(null===(n=window.shopify)||void 0===n?void 0:n.browser)?[4,window.shopify.browser.cookie.get(t)]:[3,2];case 1:return[2,o.sent()];case 2:for(t+="=",e=document.cookie.split(";"),r=0;r<e.length;r++){for(i=e[r];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return[2,i.substring(t.length,i.length)]}return[2,""]}}))}))},this.setCookie=function(t,r,i){return o(e,void 0,void 0,(function(){var e,n,o,a,c;return s(this,(function(s){switch(s.label){case 0:return e="",i&&((n=new Date).setTime(n.getTime()+60*i*1e3),e="expires=".concat(n.toUTCString(),"; ")),"myshopify.com"===(o=this.getRootDomain())&&(o=""),a="".concat(t,"=").concat(r,"; ").concat(e,"path=/; SameSite=Lax; domain=").concat(o),(null===(c=window.shopify)||void 0===c?void 0:c.browser)?[4,window.shopify.browser.cookie.set(a)]:[3,2];case 1:return s.sent(),[3,3];case 2:document.cookie=a,s.label=3;case 3:return[2]}}))}))},(null===(t=window.shopify)||void 0===t?void 0:t.init)?(this.window=window.shopify.init.context.window,this.navigator=window.shopify.init.context.navigator,this.document=window.shopify.init.context.document):(this.window=window,this.navigator=navigator,this.document=document),this.window.screen&&(this.screen_resolution="".concat(this.window.screen.width,"x").concat(this.window.screen.height));try{this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){}}return t.prototype.getRootDomain=function(){for(var t=[".co.uk",".com.au",".co.nz"],e=this.document.location.hostname,r=e.split("."),i=0;i<t.length;i++)if(e.endsWith(t[i]))return r.slice(r.length-3).join(".");return r.slice(r.length-2).join(".")},t}(),N={debug:0,info:1,warn:2,error:3,off:4},q=function(){function t(t){var e=/localhost/.test(location.hostname)?"debug":"error";this.level=this.getLevelOverride()||t||e}return t.prototype.getLevelOverride=function(){try{var t=localStorage.getItem("logLevel");if(t)return t}catch(t){}},t.prototype._log=function(t,e){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];N[this.level]<=N[t]&&"off"!==t&&console["debug"===t?"info":t].apply(console,u(["[".concat(t,"]"),e],c(r),!1))},t.prototype.debug=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._log.apply(this,u(["debug",t],c(e),!1))},t.prototype.info=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._log.apply(this,u(["info",t],c(e),!1))},t.prototype.warn=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._log.apply(this,u(["warn",t],c(e),!1))},t.prototype.error=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._log.apply(this,u(["error",t],c(e),!1))},t}();!function(t){t.SUCCESS="success",t.BLOCKED="blocked"}(d||(d={}));var A,$=function(){function t(t){this.logger=t.logger,this.config=t.config.config,this.connection_id=t.config.connection_id,this.publicToken=t.publicToken,this.cookieUrn=t.cookieUrn}return t.prototype.logEvent=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return this.logger.debug("[".concat(this.publicToken,"] [").concat(this.config.app," ID: ").concat(this.connection_id,"]"),t),e=n(n({},t),{connection_id:this.connection_id,app_profile_id:this.cookieUrn}),[4,fetch("".concat(T,"/api/tr/log?public_token=").concat(this.publicToken),{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify(e),keepalive:!0})];case 1:return r.sent(),[2]}}))}))},t}(),D=function(){function t(t,e){this.browser=t.browser,this.utils=t.utils,this.logger=t.logger,this.eventLogger=t.connectionEventLogger,this.config=t.config,this.connectionId=t.connection_id,this.eventName=e.eventName,this.properties=e.properties,this.profileProperties=e.profileProperties,this.eventID=e.eventID}return t.setup=function(t){},t.prototype.forward=function(){},t.prototype.setForwardedProfileProperties=function(t){this.forwardedProfileProperties=n(n({},this.forwardedProfileProperties),t)},t.prototype.logEvent=function(t){return o(this,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return e={event_name:this.eventName,event_properties:this.properties,profile_properties:this.profileProperties,event_id:this.eventID,pixel_method:t.method||"forward",forwarded_event_name:t.forwardedEventName,forwarded_event_id:t.forwardedEventID,forwarded_event_properties:t.forwardedProperties,forwarded_profile_properties:t.forwardedProfileProperties||this.forwardedProfileProperties},[4,this.eventLogger.logEvent(e)];case 1:return r.sent(),[2]}}))}))},t}();!function(t){t.Facebook="fb",t.GoogleAds="google_ads",t.Pinterest="pinterest",t.GA4="ga4",t.TikTok="tiktok",t.Criteo="criteo",t.Twitter="twitter",t.CustomHtml="custom_html",t.Convert="convert",t.Bing="bing",t.Klaviyo="klaviyo"}(A||(A={}));var O=function(){function t(t){var e=this;this.TRACK_METHODS=["track","trackSingle","trackCustom","trackSingleCustom"],this.SINGLE_TRACK_METHODS=["trackSingle","trackSingleCustom"],this.SHARED_TRACK_METHODS=["track","trackCustom"],this.filter=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(e.SINGLE_TRACK_METHODS.includes(t[0])&&t[1]!==e.pixelId)return!0;if("track"===t[0]||"trackSingle"===t[0]||"trackCustom"===t[0]){var i=u([],c(t),!1),n=i.shift();e.SINGLE_TRACK_METHODS.includes(n)&&i.shift();var o=i.shift(),s=i.shift(),a=i.shift(),p=null==a?void 0:a.eventID,h=!(null==a?void 0:a._convergeManaged);if(h&&(e.eventLogger.logEvent({forwarded_event_name:o,forwarded_event_id:p,forwarded_event_properties:s,pixel_method:n,external:h,status:e.block_external_tracking?d.BLOCKED:d.SUCCESS}),e.block_external_tracking))return!1}return!0},this.pixelId=t.config.pixel_id,this.block_external_tracking=!!t.config.block_external_tracking,this.logger=t.logger,this.eventLogger=t.connectionEventLogger,this.publicToken=t.publicToken,this.browser=t.browser,this.utils=t.utils}return t.prototype.constructFbq=function(t){var e=this,r=function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];try{if(!e.filter.apply(e,u([],c(r),!1)))return}catch(t){e.logger.error("[Facebook Pixel ".concat(e.pixelId,"] Error filtering event"),t),_t(t,e.browser,e.publicToken)}t.apply(void 0,u([],c(r),!1))};return r.push=r,r.loaded=!0,r.version="2.0",r.queue=[],r._convergeManaged=!0,window.fbq=r,window._fbq=r,r},t.prototype.mount=function(){if("undefined"!=typeof window){if(window.fbq){this.logger.debug("[Facebook Pixel ".concat(this.pixelId,"] Fbq already exists, overwriting and passing calls through"));var t=window.fbq,e=this.constructFbq((function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];t.apply(t,e)}));Object.assign(e,t),Object.setPrototypeOf(e,Object.getPrototypeOf(t))}else this.logger.debug("[Facebook Pixel ".concat(this.pixelId,"] Fbq does not exist, mounting on window")),this.constructFbq((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];window.fbq.callMethod?window.fbq.callMethod.apply(window.fbq,t):window.fbq.queue.push(t)}));window.fbq("init",this.pixelId),this.utils.addScript("https://connect.facebook.net/en_US/fbevents.js",{id:"cvg-facebook"}),this.logger.debug("[Facebook Pixel ".concat(this.pixelId,"] Initialized"))}},t}(),L=function(t){function r(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.pixelId=n.pixel_id,i.itemIdType=n.content_id_type||"default",i.customEvents=n.custom_events||[],i.customProperties=n.fb_custom_properties||[],i.sendSubscribedToNewsletterAsLeads=void 0===n.send_subscribed_to_newsletter_as_leads||n.send_subscribed_to_newsletter_as_leads,i}return i(r,t),r.setup=function(t){new O(t).mount()},r.prototype.track=function(t,e,r){var i=r?"trackSingleCustom":"trackSingle",o=this.getCustomProperties(this.properties),s=n(n({},e),o);window.fbq(i,this.pixelId,t,s,{eventID:this.eventID,_convergeManaged:!0}),this.logEvent({forwardedEventName:t,forwardedEventID:this.eventID,forwardedProperties:s,method:i})},r.prototype.advancedMatching=function(t){var e=t.$email||t.$email_sha256,r=t.$first_name||t.$first_name_sha256,i=t.$last_name||t.$last_name_sha256,n=t.$phone_number||t.$phone_number_sha256,o=t.$city||t.$city_sha256,s=t.$state||t.$state_sha256,a=t.$zip_code||t.$zip_code_sha256,c=t.$country_code||t.$country_code_sha256,u={external_id:t.$cookie_id&&"converge_cookie_id:".concat(t.$cookie_id),em:e,fn:r,ln:i,pn:n,ct:o,st:s,zp:a,cn:c};window.fbq("init",this.pixelId,u),this.setForwardedProfileProperties(u)},r.prototype.forward=function(){switch(this.advancedMatching(this.profileProperties),this.eventName){case"$page_load":return void this.track("PageView",{});case"Viewed Product":return void this.track("ViewContent",this.parseViewedProduct(this.properties));case"Viewed Collection":return void this.track("ViewContent",this.parseViewedCollection(this.properties));case"Added To Cart":return void this.track("AddToCart",this.parseAddedToCart(this.properties));case"Started Checkout":return void this.track("InitiateCheckout",this.parseCheckout(this.properties));case"Added Payment Info":return void this.track("AddPaymentInfo",this.parseCheckout(this.properties));case"Placed Order":return void this.track("Purchase",this.parsePlacedOrder(this.properties));case"Started Subscription":return void this.track("Subscribe",this.parseStartedSubscription(this.properties));case"Searched":return void this.track("Search",this.parseSearched(this.properties));case"Subscribed To Newsletter":return void(this.sendSubscribedToNewsletterAsLeads&&this.track("Lead",{}))}this.fireCustomEvents()},r.prototype.getContentId=function(t){if("default"===this.itemIdType)return t.variant_id||t.product_id;if("product_id"===this.itemIdType)return t.product_id;if("variant_id"===this.itemIdType)return t.variant_id;if("sku"===this.itemIdType)return t.sku;throw new Error("Unknown item id type: ".concat(this.itemIdType))},r.prototype.getContentType=function(t){if("default"===this.itemIdType)return t.variant_id?"product":"product_group";if("product_id"===this.itemIdType)return"product_group";if("variant_id"===this.itemIdType)return"product";if("sku"===this.itemIdType)return"product";throw new Error("Unknown item id type: ".concat(this.itemIdType))},r.prototype.fireCustomEvents=function(){var t,e;try{for(var r=a(this.customEvents),i=r.next();!i.done;i=r.next()){var n=i.value;if(n.converge_event_name===this.eventName){var o=this.tryParseCustomEvent(this.properties);return void this.track(n.fb_event_name,o||{},!0)}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},r.prototype.getCustomProperties=function(t){var e,r,i={};try{for(var n=a(this.customProperties),o=n.next();!o.done;o=n.next()){var s=o.value;t[s.converge_property]&&(i[s.fb_property]=t[s.converge_property])}}catch(t){e={error:t}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(e)throw e.error}}return i},r.prototype.parseViewedProduct=function(t){return{currency:t.currency,value:t.price,content_name:t.name,content_ids:[this.getContentId(t)],content_type:this.getContentType(t),contents:[{id:this.getContentId(t),quantity:1}]}},r.prototype.parseViewedCollection=function(t){var e,r,i,n,o,s=this;return{content_name:t.name,content_type:(null===(e=t.items)||void 0===e?void 0:e.length)?this.getContentType(t.items[0]):void 0,content_category:t.name,currency:(null===(r=t.items)||void 0===r?void 0:r.length)?null===(i=t.items[0])||void 0===i?void 0:i.currency:void 0,content_ids:null===(n=t.items)||void 0===n?void 0:n.map(this.getContentId.bind(this)),contents:null===(o=t.items)||void 0===o?void 0:o.map((function(t){return{id:s.getContentId(t),quantity:1}}))}},r.prototype.parseAddedToCart=function(t){return{currency:t.currency,value:t.price*(t.quantity||1),content_name:t.name,content_ids:[this.getContentId(t)],content_type:this.getContentType(t),contents:[{id:this.getContentId(t),quantity:t.quantity}]}},r.prototype.parseSearched=function(t){return{search_string:t.query}},r.prototype.parseCheckout=function(t){var e,r,i,n,o=this;return{currency:t.currency,value:t.total_price,num_items:null===(e=t.items)||void 0===e?void 0:e.reduce((function(t,e){return t+e.quantity}),0),content_type:(null===(r=t.items)||void 0===r?void 0:r.length)?this.getContentType(t.items[0]):void 0,content_ids:null===(i=t.items)||void 0===i?void 0:i.map(this.getContentId.bind(this)),contents:null===(n=t.items)||void 0===n?void 0:n.map((function(t){return{id:o.getContentId(t),quantity:t.quantity}}))}},r.prototype.parsePlacedOrder=function(t){return n(n({},this.parseCheckout(t)),{order_id:t.id})},r.prototype.parseStartedSubscription=function(t){return n(n({},this.parseCheckout(t)),{order_id:t.id,subscription_id:t.id})},r.prototype.tryGetQuantity=function(t){if("object"===e(t)&&null!==t){var r=t.quantity;if("number"==typeof r)return r;if(void 0===r)return 1}},r.prototype.tryGetContent=function(t){if("object"===e(t)&&null!==t)return{id:this.getContentId(t),type:this.getContentType(t),quantity:this.tryGetQuantity(t)}},r.prototype.tryParseCustomEvent=function(t){var e,r;if(void 0!==t.total_price&&t.currency){var i=void 0;r=t.items,Array.isArray(r)&&(i=t.items.map(this.tryGetContent.bind(this)).filter((function(t){return!!t})));var n=null==i?void 0:i.reduce((function(t,e){return t+((null==e?void 0:e.quantity)||0)}),0),o=null===(e=null==i?void 0:i[0])||void 0===e?void 0:e.type,s=null==i?void 0:i.map((function(t){return null==t?void 0:t.id})).filter((function(t){return"string"==typeof t}));return{currency:t.currency,value:t.total_price,num_items:n,content_type:o,content_ids:s,contents:i}}if(t.currency&&void 0!==t.price){var a=this.tryGetContent(t);if((null==a?void 0:a.id)&&(null==a?void 0:a.type))return{currency:t.currency,value:t.price,content_name:t.name,content_ids:[a.id],content_type:a.type,contents:[{id:a.id,quantity:this.tryGetQuantity(t)}]}}},r}(D),U=(0).constructor,V=U.isFinite;U.isInteger;var j=[].constructor.isArray;function R(t){return null!==t&&"object"==typeof t}function M(t,e){return void 0===e&&(e=0),"string"==typeof t&&t.length>=e}function F(t){return V(t)}function G(t){return j(t)}function B(t,e){return R(t)&&e in t}var K="'\"`",z=new(function(){function t(t){this.size=t,this.reset()}return t.prototype.reset=function(){this.oldestIndex=0,this.map={},this.cachedKeys=new Array(this.size)},t.prototype.get=function(t){return this.map[t]},t.prototype.set=function(t,e){this.map[t]=e;var r=this.cachedKeys[this.oldestIndex];void 0!==r&&delete this.map[r],this.cachedKeys[this.oldestIndex]=t,this.oldestIndex++,this.oldestIndex%=this.size},t}())(1e3);function H(t){var e=t.charAt(0),r=t.substr(-1);if(K.includes(e)||K.includes(r)){if(t.length<2||e!==r)throw new SyntaxError('Mismatching string quotation: "'+t+'"');return t.substring(1,t.length-1)}if(t.includes("["))throw new SyntaxError('Missing ] in varName "'+t+'"');return"+"===e?t.substr(1):t}function Q(t,e,r){var i=e.trim();if(""===i)return t;if(i.startsWith(".")){if(!r)throw new SyntaxError('Unexpected . at the start of "'+e+'"');if(""===(i=i.substr(1).trim()))return t}else if(r)throw new SyntaxError('Missing . at the start of "'+e+'"');if(i.endsWith("."))throw new SyntaxError('Unexpected "." at the end of "'+e+'"');for(var n=0,o=i.split(".");n<o.length;n++){var s=o[n].trim();if(""===s)throw new SyntaxError('Empty prop name when parsing "'+e+'"');t.push(s)}return t}function J(t){if(!M(t))throw new TypeError("Cannot parse path. Expected string. Got a "+typeof t);for(var e,r,i=0,n=!1,o=new Array(0),s=0;s<t.length&&-1!==(e=t.indexOf("[",s));s=i){if(-1===(i=t.indexOf("]",e)))throw new SyntaxError('Missing ] in varName "'+t+'"');if(0===(r=t.substring(e+1,i).trim()).length)throw new SyntaxError("Unexpected token ]");i++,Q(o,t.substring(s,e),n),o.push(H(r)),n=!0}return Q(o,t.substring(i),n)}function W(t,e,r){if(void 0===r&&(r={}),!R(r))throw new TypeError("get expects an object option. Got "+typeof r);var i=r.depth,n=void 0===i?10:i;if(!F(n)||n<=0)throw new RangeError("Expected a positive number for depth. Got "+n);var o=Array.isArray(e)?e:J.cached(e),s=function(){return o.join(" > ")};if(o.length>n)throw new ReferenceError("The path cannot be deeper than "+n+' levels. Got "'+s()+'"');for(var a=t,c=0,u=o;c<u.length;c++){var d=u[c];if(!B(a,d)){if(r.propsExist)throw new ReferenceError(d+' is not defined in the scope at path: "'+s()+'"');return}a=a[d]}return a}J.cached=function(t){var e=z.get(t);return void 0===e&&(e=J(t),z.set(t,e)),e};var Z=function(){function t(t,e){var r=this;if(void 0===e&&(e={}),this.tokens=t,this.options=e,this.render=function(t){void 0===t&&(t={});var e=r.tokens.varNames.length;r.cacheParsedPaths();for(var i=new Array(e),n=0;n<e;n++)i[n]=W(t,r.toPathCache[n],r.options);return r.stringify(i)},this.renderFn=function(t,e){void 0===e&&(e={});var i=r.resolveVarNames(t,e);return r.stringify(i)},this.renderFnAsync=function(t,e){return void 0===e&&(e={}),Promise.all(r.resolveVarNames(t,e)).then((function(t){return r.stringify(t)}))},!R(t)||!G(t.strings)||!G(t.varNames)||t.strings.length!==t.varNames.length+1)throw new TypeError("Invalid tokens object");if(!R(e))throw new TypeError("Options should be an object. Got a "+typeof e);e.validateVarNames&&this.cacheParsedPaths()}return t.prototype.cacheParsedPaths=function(){var t=this.tokens.varNames;if(void 0===this.toPathCache){this.toPathCache=new Array(t.length);for(var e=0;e<t.length;e++)this.toPathCache[e]=J.cached(t[e])}},t.prototype.resolveVarNames=function(t,e){void 0===e&&(e={});var r=this.tokens.varNames;if("function"!=typeof t)throw new TypeError("Expected a resolver function. Got "+String(t));for(var i=r.length,n=new Array(i),o=0;o<i;o++)n[o]=t.call(null,r[o],e);return n},t.prototype.stringify=function(t){for(var e=this.tokens.strings,r=this.options.explicit,i=t.length,n="",o=0;o<i;o++){n+=e[o];var s=t[o];(r||null!=s)&&(n+=s)}return n+=e[i]},t}();function X(t,e){void 0===e&&(e={});var r=function(t,e){if(void 0===e&&(e={}),!M(t))throw new TypeError("The template parameter must be a string. Got a "+typeof t);if(!R(e))throw new TypeError("Options should be an object. Got a "+typeof e);var r=e.tags,i=void 0===r?["{{","}}"]:r,n=e.maxVarNameLength,o=void 0===n?1e3:n;if(!G(i)||2!==i.length)throw TypeError("tags should be an array of two elements. Got "+String(i));var s=i[0],a=i[1];if(!M(s,1)||!M(a,1)||s===a)throw new TypeError('The open and close symbols should be two distinct non-empty strings. Got "'+s+'" and "'+a+'"');if(!F(o)||o<=0)throw new Error("Expected a positive number for maxVarNameLength. Got "+o);for(var c,u,d=s.length,p=a.length,h=0,l=[],f=[],v=0;v<t.length&&-1!==(c=t.indexOf(s,v));){var m=c+d;if(-1===(h=t.substr(m,o+p).indexOf(a)))throw new SyntaxError('Missing "'+a+'" in the template for the "'+s+'" at position '+c+" within "+o+" characters");if(h+=m,0===(u=t.substring(m,h).trim()).length)throw new SyntaxError('Unexpected "'+a+'" tag found at position '+c);if(u.includes(s))throw new SyntaxError('Variable names cannot have "'+s+'". But at position '+c+'. Got "'+u+'"');f.push(u),h+=p,l.push(t.substring(v,c)),v=h}return l.push(t.substring(h)),{strings:l,varNames:f}}(t,e);return new Z(r,e)}var Y,tt=function(t){if("undefined"!=typeof document&&void 0!==document.body){var e=document.createRange().createContextualFragment(t);document.body.append(e)}},et=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.setupHtml=n.setup_html,i.eventHtml=n.event_html.map((function(t){return{contentRenderer:X(t.content),eventName:t.event_name}})),i}return i(e,t),e.setup=function(t){if("undefined"!=typeof window){var e=t.config;e.setup_html.length>0&&tt(e.setup_html)}},e.prototype.forward=function(){var t,e;try{for(var r=a(this.eventHtml),i=r.next();!i.done;i=r.next()){var n=i.value;if(n.eventName===this.eventName){var o=n.contentRenderer.render(this.properties);tt(o),this.logEvent({forwardedEventName:n.eventName,forwardedProperties:{content:o}})}}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e}(D),rt=function(){function t(t){var e=t.config;this.tagId=e.tag_id,this.dataLayerName=e.internal_converge_data_layer?v:"dataLayer",this.utils=t.utils}return t.prototype.mount=function(){"undefined"!=typeof window&&(this.utils.addScript("https://www.googletagmanager.com/gtag/js?id=".concat(this.tagId,"&l=").concat(this.dataLayerName),{id:"gtag-".concat(this.tagId)}),this.gtag("js",new Date),this.gtag("config",this.tagId))},t.prototype.gtag=function(){var t;"undefined"!=typeof window&&(window[this.dataLayerName]=window[this.dataLayerName]||[],null===(t=window[this.dataLayerName])||void 0===t||t.push(arguments))},t}(),it=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;i.tagId=n.tag_id,i.itemIdType=n.item_id_type||"product_id",i.customEvents=n.custom_google_ads_events||[],i.conversions=n.conversions||[];var o=new rt(e);return i.gtag=o.gtag.bind(o),i}return i(e,t),e.setup=function(t){new rt(t).mount()},e.prototype.send=function(t,e){this.gtag("event",t,n(n({},e),{send_to:this.tagId})),this.logEvent({forwardedEventName:t,forwardedProperties:e,method:"event"})},e.prototype.forward=function(){var t,e,r=this.eventName,i=this.properties;switch(this.setUserData(),this.trackConversions(),r){case"Viewed Product":this.send("view_item",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Selected Product":this.send("select_item",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Viewed Collection":this.send("view_item_list",{items:null===(t=i.items)||void 0===t?void 0:t.map(this.parseItem.bind(this))});break;case"Added To Cart":this.send("add_to_cart",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Removed From Cart":this.send("remove_from_cart",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Added To Wishlist":this.send("add_to_wishlist",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Removed From Wishlist":this.send("remove_from_wishlist",{value:i.price,currency:i.currency,items:[this.parseItem(i)]});break;case"Searched For Store":this.send("search",{value:null===(e=i.product)||void 0===e?void 0:e.price,currency:null==i?void 0:i.currency,location:i.query,items:i.product&&[this.parseItem(i.product)]});break;case"Viewed Cart":this.send("view_cart",this.parseCheckout(i));break;case"Started Checkout":this.send("begin_checkout",this.parseCheckout(i));break;case"Added Payment Info":this.send("add_payment_info",this.parseCheckout(i));break;case"Placed Order":this.send("purchase",this.parseCheckout(i))}this.fireCustomEvents()},e.prototype.fireCustomEvents=function(){var t,e;try{for(var r=a(this.customEvents),i=r.next();!i.done;i=r.next()){var n=i.value;this.eventName===n.event_name&&this.send(n.google_ads_event_name,{value:this.properties.price||this.properties.total_price,currency:this.properties.currency,items:[{id:this.getItemId(this.properties),google_business_vertical:"retail"}]})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.getItemId=function(t){if("product_id"===this.itemIdType)return t.product_id;if("variant_id"===this.itemIdType)return t.variant_id;if("sku"===this.itemIdType)return t.sku;throw new Error("Invalid item_id_type ".concat(this.itemIdType))},e.prototype.parseItem=function(t){return{id:this.getItemId(t),google_business_vertical:"retail"}},e.prototype.parseCheckout=function(t){var e;return{value:t.total_price,currency:t.currency,items:null===(e=t.items)||void 0===e?void 0:e.map(this.parseItem.bind(this))}},e.prototype.trackConversions=function(){var t,e,r=this,i=r.eventName,o=r.properties,s=r.eventID;try{for(var c=a(this.conversions),u=c.next();!u.done;u=c.next()){var d=u.value;if(i===d.event_name&&d.conversion_id.length>0){var p={value:o.total_price||o.price,currency:o.currency,transaction_id:s},h="".concat(this.tagId,"/").concat(d.conversion_id);this.gtag("event","conversion",n({send_to:h},p)),this.logEvent({forwardedEventName:h,forwardedProperties:p,forwardedEventID:s,method:"conversion"})}}}catch(e){t={error:e}}finally{try{u&&!u.done&&(e=c.return)&&e.call(c)}finally{if(t)throw t.error}}},e.prototype.setUserData=function(){var t=this.profileProperties,e={email:t.$email,phone_number:t.$phone_number,address:{first_name:t.$first_name,last_name:t.$last_name,street:t.$street,city:t.$city,region:t.$state,postal_code:t.$zip_code,country:t.$country_code}};this.gtag("set","user_data",e),this.setForwardedProfileProperties(e)},e}(D),nt=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.tagId=n.tag_id,i.contentIdType=n.pinterest_content_id_type||"product_id",i}return i(e,t),e.setup=function(t){if("undefined"!=typeof window){var e=t.utils,r=t.config;e.addScript("https://s.pinimg.com/ct/core.js",{id:"cvg-pinterest"}),window.pintrk||(window.pintrk=function(){window.pintrk.queue.push(Array.prototype.slice.call(arguments))},window.pintrk.queue=[],window.pintrk.version="3.0"),window.pintrk("load",r.tag_id)}},e.prototype.track=function(t,e,r){window.pintrk("track",t,n(n({},e),{eventID:r})),this.logEvent({forwardedEventName:t,forwardedProperties:e,forwardedEventID:r,method:"track"})},e.prototype.forward=function(){var t,e=this,r=this,i=r.eventName,n=r.properties,o=r.eventID;switch(this.advancedMatching(),i){case"$page_load":window.pintrk("page"),this.logEvent({forwardedEventName:"page",method:"page"});break;case"Viewed Product":this.track("PageVisit",this.parseProduct(n),"page_visit::".concat(o));break;case"Viewed Collection":this.track("ViewCategory",{category_id:n.id,category_name:n.name,items:null===(t=n.items)||void 0===t?void 0:t.map((function(t){return e.parseProduct(t)}))},"view_category::".concat(o));break;case"Added To Cart":this.track("AddToCart",this.parseProduct(n),"add_to_cart::".concat(o));break;case"Placed Order":this.track("Checkout",this.parseCheckout(n),"checkout::".concat(o));break;case"Searched":this.track("Search",{search_query:n.query},"search::".concat(o));break;case"Subscribed To Newsletter":this.track("Lead",{},"lead::".concat(o))}},e.prototype.advancedMatching=function(){var t=this.profileProperties.$email;t&&t.length&&window.pintrk("load",this.tagId,{em:t}),this.setForwardedProfileProperties({em:t})},e.prototype.parseProduct=function(t){return{value:t.price,currency:t.currency,product_name:t.name,product_id:"sku"===this.contentIdType?t.sku:"variant_id"===this.contentIdType?t.variant_id:t.product_id,product_variant_id:t.variant_id,product_variant:t.variant_name,product_price:t.price,product_quantity:t.quantity}},e.prototype.parseCheckout=function(t){var e,r,i=this;return{value:t.total_price,currency:t.currency,order_quantity:null===(e=t.items)||void 0===e?void 0:e.reduce((function(t,e){return t+e.quantity}),0),order_id:t.id,line_items:null===(r=t.items)||void 0===r?void 0:r.map((function(t){return i.parseProduct(t)}))}},e}(D),ot=function(){function t(t){var e=t.config,r=t.connection_id;this.connectionId=r,this.measurementId=e.measurement_id,this.connectionType=e.connection_type||"server";var i=!!e.internal_converge_data_layer||"sgtm"===this.connectionType;this.dataLayerName=i?"".concat(v,"_").concat(this.connectionId):"dataLayer",this.useConvergeHostedScript=!!e.use_converge_hosted_script,this.gtmUrl=e.use_converge_hosted_script?"https://static.sgtm.runconverge.com/js":"https://www.googletagmanager.com/gtag/js",this.utils=t.utils,this.browser=t.browser,this.logger=t.logger}return t.prototype.mount=function(){"undefined"!=typeof window&&(this.utils.addScript("".concat(this.gtmUrl,"?id=").concat(this.measurementId,"&l=").concat(this.dataLayerName),{id:"gtag-".concat(this.useConvergeHostedScript,"-").concat(this.dataLayerName,"-").concat(this.measurementId)}),this.gtag("js",new Date),this.gtag("config",this.measurementId,{page_location:this.browser.window.location.href,page_title:this.browser.document.title,send_page_view:!1,cvg_ga4_measurement_id_:this.measurementId,server_container_url:"sgtm"===this.connectionType?"https://sgtm.runconverge.com":void 0}))},t.prototype.gtag=function(){var t;if("undefined"!=typeof window){var e=window;e[this.dataLayerName]=e[this.dataLayerName]||[];try{null===(t=e[this.dataLayerName])||void 0===t||t.push(arguments)}catch(t){this.logger.error("Could not push to dataLayer",t)}}},t}(),st=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;i.measurementId=n.measurement_id,i.itemIdType=n.item_id_type||"product_id",i.customForwarding=n.custom_ga4_events||[],i.connectionType=n.connection_type||"server",i.userProperties=n.user_properties||[],i.eventProperties=n.ga4_event_properties||[],i.itemProperties=n.ga4_item_properties||[],i.setUserId=!!n.set_user_id;var o=new ot(e);return i.dataLayerName=o.dataLayerName,i.gtag=o.gtag.bind(o),i}return i(e,t),e.setup=function(t){new ot(t).mount()},e.prototype.send=function(t,e){var r=n(n(n({},e),this.getCustomEventProperties()),{connection_type:"sgtm"===this.connectionType?"sgtm":"client"}),i=this.userId;i&&(r.user_id=i,this.setForwardedProfileProperties({user_id:i})),this.gtag("event",t,n(n({},r),{send_to:"sgtm"!==this.connectionType?this.measurementId:void 0})),this.logEvent({forwardedEventName:t,forwardedProperties:r,method:"event"})},e.prototype.getCustomEventProperties=function(){var t=this;return n({},this.eventProperties.reduce((function(e,r){return e[r.forward]=t.properties[r.converge],e}),{}))},e.prototype.forward=function(){var t;if(this.setUserProperties(),"$page_load"!==this.eventName){if("server"!==this.connectionType)switch(this.eventName){case"Viewed Product":this.send("view_item",this.parseProduct(this.properties));break;case"Logged In":this.send("login",{});break;case"Signed Up":this.send("sign_up",{});break;case"Selected Product":this.send("select_item",this.parseProduct(this.properties));break;case"Added To Cart":this.send("add_to_cart",this.parseProduct(this.properties));break;case"Added To Wishlist":this.send("add_to_wishlist",this.parseProduct(this.properties));break;case"Removed From Cart":this.send("remove_from_cart",this.parseProduct(this.properties));break;case"Viewed Cart":this.send("view_cart",this.parseCheckout(this.properties));break;case"Started Checkout":this.send("begin_checkout",this.parseCheckout(this.properties));break;case"Searched":this.send("search",{search_term:this.properties.query});break;case"Viewed Collection":this.send("view_item_list",{item_list_id:this.properties.id,item_list_name:this.properties.name,items:null===(t=this.properties.items)||void 0===t?void 0:t.map(this.parseItem.bind(this))});break;case"Added Contact Info":this.send("add_contact_info",this.parseCheckout(this.properties));break;case"Added Shipping Info":this.send("add_shipping_info",this.parseCheckout(this.properties));break;case"Added Payment Info":this.send("add_payment_info",this.parseCheckout(this.properties));break;case"Placed Order":"sgtm"!==this.connectionType&&this.send("purchase",this.parseOrder(this.properties));break;default:this.trackCustomEvents()}}else this.send("page_view",{page_type:this.properties.page_type})},Object.defineProperty(e.prototype,"userId",{get:function(){if("server"!==this.connectionType&&this.setUserId){var t=this.profileProperties.$customer_id;if(t){var e=t.toString();if(""!==e)return"customer_id:".concat(e)}}},enumerable:!1,configurable:!0}),e.prototype.setUserProperties=function(){var t=this,e=n({},this.userProperties.reduce((function(e,r){var i=r.profile_property;return e[r.ga4_property]=t.profileProperties[i],e}),{}));this.gtag("set","user_properties",e),this.setForwardedProfileProperties(e)},e.prototype.getCustomItemProperties=function(t){return n({},this.itemProperties.reduce((function(e,r){return e[r.forward]=t[r.converge],e}),{}))},e.prototype.parseItem=function(t){return n({item_id:t[this.itemIdType],item_name:t.name,item_brand:t.vendor,item_variant:t.variant_id||t.variant_name,price:t.price,currency:t.currency,quantity:n({quantity:void 0},t).quantity},this.getCustomItemProperties(t))},e.prototype.parseProduct=function(t){return{value:t.price,currency:t.currency,items:[this.parseItem(t)]}},e.prototype.parseCheckout=function(t){var e;return{value:t.total_price,currency:t.currency,coupon:t.coupon&&t.coupon.join(","),shipping:t.total_shipping,tax:t.total_tax,items:null===(e=t.items)||void 0===e?void 0:e.map(this.parseItem.bind(this))}},e.prototype.parseOrder=function(t){return n(n({},this.parseCheckout(t)),{transaction_id:t.id})},e.prototype.trackCustomEvents=function(){var t,e;try{for(var r=a(this.customForwarding),i=r.next();!i.done;i=r.next()){var n=i.value;n.converge_event_name===this.eventName&&this.send(n.ga4_event_name,{})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e}(D),at=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.pixelCode=n.pixel_code,i.contentIdType=n.content_id_type||"default",i}return i(e,t),e.setup=function(t){var e,r;if("undefined"!=typeof window){var i=t.utils,n=t.config;window.TiktokAnalyticsObject="ttq";var o=window.ttq=window.ttq||[];o._i=o._i||{},o._i[n.pixel_code]=[],o._i[n.pixel_code]._u="https://analytics.tiktok.com/i18n/pixel/events.js",o._t=o._t||{},o._t[n.pixel_code]=+new Date,o._o=o._o||{},o._o[n.pixel_code]={};var s=n.pixel_code,c=function(t){o[t]=function(){o._i[s].push([t].concat(Array.prototype.slice.call(arguments,0)))}};try{for(var u=a(["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie"]),d=u.next();!d.done;d=u.next()){c(d.value)}}catch(t){e={error:t}}finally{try{d&&!d.done&&(r=u.return)&&r.call(u)}finally{if(e)throw e.error}}i.addScript("https://analytics.tiktok.com/i18n/pixel/events.js?sdkid="+n.pixel_code,{id:"cvg-tiktok-"+n.pixel_code})}},e.prototype.parsePhoneNumber=function(t){return t?t.replace(/[\s-]/g,""):void 0},e.prototype.advancedMatching=function(){var t=this.profileProperties,e={email:t.$email||void 0,phone_number:this.parsePhoneNumber(t.$phone_number)};window.ttq.identify(e),this.setForwardedProfileProperties(e)},e.prototype.forward=function(){var t=this.eventName,e=this.properties;switch(this.advancedMatching(),t){case"$page_load":this.page();break;case"Viewed Product":this.track("ViewContent",this.parseViewedProduct(e));break;case"Added To Cart":this.track("AddToCart",this.parseAddedToCart(e));break;case"Started Checkout":this.track("InitiateCheckout",this.parseCheckout(e));break;case"Added Payment Info":this.track("AddPaymentInfo",this.parseCheckout(e));break;case"Placed Order":this.track("CompletePayment",this.parseCheckout(e));break;case"Searched":this.track("Search",this.parseSearched(e));break;case"Subscribed To Newsletter":this.track("CompleteRegistration",{})}},e.prototype.track=function(t,e){window.ttq.track(t,e,{event_id:this.eventID}),this.logEvent({forwardedEventName:t,forwardedProperties:e,forwardedEventID:this.eventID,method:"track"})},e.prototype.page=function(){window.ttq.page({event_id:this.eventID}),this.logEvent({forwardedEventName:"page",forwardedEventID:this.eventID,method:"page"})},e.prototype.getContentId=function(t){if("default"===this.contentIdType)return t.variant_id||t.product_id;if("product_id"===this.contentIdType)return t.product_id;if("variant_id"===this.contentIdType)return t.variant_id;if("sku"===this.contentIdType)return t.sku;throw new Error("Unknown content id type: ".concat(this.contentIdType))},e.prototype.getContentType=function(t){if("default"===this.contentIdType)return t.variant_id?"product":"product_group";if("product_id"===this.contentIdType)return"product_group";if("variant_id"===this.contentIdType)return"product";if("sku"===this.contentIdType)return"product";throw new Error("Unknown content id type: ".concat(this.contentIdType))},e.prototype.parseViewedProduct=function(t){return{currency:t.currency,value:t.price,content_type:this.getContentType(t),contents:[{content_id:this.getContentId(t),content_name:t.name,price:t.price,brand:t.vendor}]}},e.prototype.parseAddedToCart=function(t){return{currency:t.currency,value:t.price*t.quantity,content_type:this.getContentType(t),contents:[{content_id:this.getContentId(t),content_name:t.name,quantity:t.quantity,price:t.price,brand:t.vendor}]}},e.prototype.parseSearched=function(t){return{query:t.query}},e.prototype.parseCheckout=function(t){var e,r=this;return{currency:t.currency,value:t.total_price,content_type:t.items?this.getContentType(t.items[0]):void 0,contents:null===(e=t.items)||void 0===e?void 0:e.map((function(t){return{content_id:r.getContentId(t),content_name:t.name,price:t.price,quantity:t.quantity,brand:t.vendor}}))}},e}(D),ct=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.accountId=n.account_id,i}return i(e,t),e.setup=function(t){if("undefined"!=typeof window){var e=t.config;t.utils.addScript("https://dynamic.criteo.com/js/ld/ld.js?a="+e.account_id,{id:"cvg-criteo-"+e.account_id})}},e.prototype.getDeviceType=function(){return/iPad/.test(navigator.userAgent)?"t":/Mobile|iP(hone|od)|Android|BlackBerry|IEMobile|Silk/.test(navigator.userAgent)?"m":"d"},e.prototype.forward=function(){if("$page_load"===this.eventName)this.viewedPage(this.properties,this.eventID)},e.prototype.viewedPage=function(t,e){var r=this.getDeviceType();window.criteo_q=window.criteo_q||[],window.criteo_q.push({event:"setAccount",account:this.accountId},{event:"setSiteType",type:r},{event:"viewPage"}),this.logEvent({forwardedEventName:"viewPage",forwardedProperties:{account:this.accountId,type:r},method:"event"})},e}(D),ut=function(t){function e(e,r){return t.call(this,e,r)||this}return i(e,t),e.setup=function(t){if("undefined"!=typeof window){var e=t.utils,r=t.browser,i=t.config;e.addScript("https://static.ads-twitter.com/uwt.js",{id:"cvg-twitter"}),window.twq||(window.twq=function(){window.twq.exe?window.twq.exe.apply(window.twq,arguments):window.twq.queue.push(arguments)},window.twq.queue=[],window.twq.version="1.1"),window.twq("set",{page_location:r.document.location.href}),window.twq("config",i.pixel_id)}},e.prototype.track=function(t,e){var r={email_address:this.profileProperties.$email,phone_number:this.profileProperties.$phone_number};window.twq("event","tw-".concat(this.config.pixel_id,"-").concat(t),n(n(n({},e),{conversion_id:this.eventID}),r)),this.logEvent({forwardedEventName:t,forwardedProperties:e,forwardedProfileProperties:r,forwardedEventID:this.eventID,method:"event"})},e.prototype.forward=function(){var t=this.eventName,e=this.properties;switch(t){case"$page_load":this.config.page_view_id&&this.track(this.config.page_view_id,{});break;case"Viewed Product":this.config.viewed_product_id&&this.track(this.config.viewed_product_id,{value:e.price,currency:e.currency,contents:[this.parseContent(e)]});break;case"Added To Cart":this.config.added_to_cart_id&&this.track(this.config.added_to_cart_id,{value:e.price*e.quantity,currency:e.currency,contents:[this.parseContent(e)]});break;case"Started Checkout":this.config.started_checkout_id&&this.track(this.config.started_checkout_id,this.parseCheckout(e));break;case"Added Payment Info":this.config.added_payment_info_id&&this.track(this.config.added_payment_info_id,this.parseCheckout(e));break;case"Placed Order":this.config.placed_order_id&&this.track(this.config.placed_order_id,this.parseCheckout(e))}},e.prototype.parseContent=function(t){var e=t.quantity;return{content_id:t[this.config.twitter_content_id_type],content_group_id:t.product_id,content_name:t.name,content_price:Number(t.price),num_items:void 0!==e?Number(e):1}},e.prototype.parseCheckout=function(t){var e;return{value:Number(t.total_price),currency:t.currency,contents:null===(e=t.items)||void 0===e?void 0:e.map(this.parseContent.bind(this))}},e}(D),dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.setup=function(t){var e=this;if("undefined"!=typeof window){var r=t.config,i="".concat(r.account_id,"-").concat(r.project_id);window.convert?document.addEventListener("DOMContentLoaded",(function(){e.trackViewedConvertExperiment(t)})):t.utils.addScript("https://cdn-4.convertexperiments.com/js/".concat(i,".js"),{id:"cvg-convert-".concat(i),sync:!0,onLoad:function(){return e.trackViewedConvertExperiment(t)}})}},e.trackViewedConvertExperiment=function(t){var e=function(){var t=window.convert;if(t){var e=t.getCookie("_conv_s");if(("{}"!=JSON.stringify(t.currentData.experiments)||"{}"!=JSON.stringify(t.historicalData.experiments))&&e){var r=e.substring(e.lastIndexOf("sh:")+3,e.lastIndexOf("*")),i=[],n=[],o=void 0;if(t.currentData){var s=t.currentData.experiments;for(var a in s)o=s[a].variation_id,i.includes(t.data.experiments[a].id)||(i.push(t.data.experiments[a].id),n.push(o))}if(t.historicalData){var c=t.historicalData.experiments;for(var a in c)o=c[a].variation_id,i.includes(t.data.experiments[a].id)||(i.push(t.data.experiments[a].id),n.push(o))}return{cid:t.data.u_id,pid:t.data.prj.id,vid:r,vars:n,exps:i,seg:t.getVisitorSegments()}}}}();if(e&&0!==Object.keys(e).length){var r=Object.fromEntries(Object.entries(e).map((function(t){var e=c(t,2),r=e[0],i=e[1];return["$convert_".concat(r),i]})));t.pixel.track({method:"track",eventName:"Viewed Convert Experiment",profileProperties:r})}},e}(D),pt=function(){function t(t){this.uetq=[];var e=t.config;this.tagId=e.tag_id,this.utils=t.utils}return t.prototype.mount=function(){if("undefined"!=typeof window){this.setupUET(this.tagId);var t=this;this.utils.addScript("https://bat.bing.com/bat.js",{id:"cvg-bing",onLoad:function(){for(var e in window._cvg_uetqs||{})t.setupUET(e)},allowDuplicateSrc:!0})}},t.prototype.setupUET=function(t){window._cvg_uetqs=window._cvg_uetqs||{},window._cvg_uetqs[t]=window._cvg_uetqs[t]||[];var e=window._cvg_uetqs[t];window.UET&&!e.hasOwnProperty("domain")&&(window._cvg_uetqs[t]=new window.UET({ti:t,q:window._cvg_uetqs[t]})).push("pageLoad")},t.prototype.pushToUetq=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof window){window._cvg_uetqs=window._cvg_uetqs||{};var r=window._cvg_uetqs[this.tagId]=window._cvg_uetqs[this.tagId]||[];r.push.apply(r,u([],c(t),!1))}},t}(),ht=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;i.itemIdType=n.item_id_type||"product_id",i.customEvents=n.custom_bing_events||[];var o=new pt(e);return i.pushToUetq=o.pushToUetq.bind(o),i}return i(e,t),e.setup=function(t){new pt(t).mount()},e.prototype.send=function(t,e){var r=this.getEnhancedConversionsProperties();this.pushToUetq("event",t,n(n(n({},e),r),{transaction_id:this.eventID})),this.logEvent({forwardedEventName:t,forwardedProperties:e,forwardedProfileProperties:r,forwardedEventID:this.eventID,method:"event"})},e.prototype.forward=function(){var t=this.eventName,e=this.properties;switch(t){case"$page_load":this.send("page_view",{page_path:this.browser.window.location.pathname,page_title:this.browser.document.title}),"/"===this.browser.window.location.pathname&&this.send("",{ecomm_pagetype:"home"});break;case"Viewed Product":this.send("view_item",this.parseProduct(e));break;case"Viewed Collection":this.send("view_item_list",this.parseCollection(e));break;case"Added To Cart":this.send("add_to_cart",this.parseProduct(e,"cart"));break;case"Searched":this.send("view_search_results",{search_term:e.query});break;case"Started Checkout":this.send("begin_checkout",this.parseCheckout(e));break;case"Added Payment Info":this.send("add_payment_info",this.parseCheckout(e));break;case"Placed Order":this.send("purchase",this.parseCheckout(e,!0))}this.fireCustomEvents()},e.prototype.parseCollection=function(t){var e;return{ecomm_prodid:this.getEcommProdid(t.items),ecomm_pagetype:"category",items:null===(e=t.items)||void 0===e?void 0:e.map(this.parseItem.bind(this))}},e.prototype.parseProduct=function(t,e){void 0===e&&(e="product");var r=n({quantity:1},t).quantity,i=(t.price||0)*r;return{ecomm_prodid:this.getEcommProdid([t]),ecomm_pagetype:e,ecomm_totalvalue:i,revenue_value:i,currency:t.currency,items:[this.parseItem(t)]}},e.prototype.fireCustomEvents=function(){var t,e;try{for(var r=a(this.customEvents),i=r.next();!i.done;i=r.next()){var n=i.value;this.eventName===n.event_name&&this.send(n.bing_event_name,{})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=r.return)&&e.call(r)}finally{if(t)throw t.error}}},e.prototype.getItemId=function(t){if("product_id"===this.itemIdType)return t.product_id;if("variant_id"===this.itemIdType)return t.variant_id;if("sku"===this.itemIdType)return t.sku;throw new Error("Invalid item_id_type ".concat(this.itemIdType))},e.prototype.parseItem=function(t){return{id:this.getItemId(t),quantity:n({quantity:1},t).quantity,price:t.price}},e.prototype.parseCheckout=function(t,e){var r;return{ecomm_prodid:this.getEcommProdid(t.items),ecomm_totalvalue:t.total_price,ecomm_pagetype:e?"purchase":"cart",revenue_value:t.total_price,currency:t.currency,items:null===(r=t.items)||void 0===r?void 0:r.map(this.parseItem.bind(this))}},e.prototype.getEcommProdid=function(t){var e=null==t?void 0:t.map(this.getItemId.bind(this)).filter((function(t){return t&&t.length>0}));return e&&e.length>0?e:void 0},e.prototype.getEnhancedConversionsProperties=function(){var t=this.profileProperties,e=t.$email,r=t.$phone_number;return e||r?{pid:{em:e,ph:r}}:{}},e}(D),lt=function(t){function e(e,r){var i=t.call(this,e,r)||this,n=e.config;return i.publicToken=n.public_token,i}return i(e,t),e.prototype.forward=function(){switch(this.eventName){case"$page_load":this.loadScript();break;case"Viewed Product":this.track("Viewed Product",this.parseProduct(this.properties));break;case"Added To Cart":this.track("Added to Cart",this.parseLineItem(this.properties));break;case"Started Checkout":this.track("Started Checkout",this.parseCheckout(this.properties))}},e.prototype.isIdentified=function(){return o(this,void 0,void 0,(function(){var t,e,r,i;return s(this,(function(n){switch(n.label){case 0:return(t=this.utils.getURLParameterByName("_kx"))&&t.length>0?[2,!0]:[4,this.browser.getCookie("__kla_id")];case 1:e=n.sent();try{if(0===(r=atob(e)).length)return[2,!1];if(null==(i=JSON.parse(r))?void 0:i.$exchange_id)return[2,!0]}catch(t){this.logger.error("Could not decode klaID",t)}return[2,!1]}}))}))},e.prototype.loadScript=function(){var t=this;this.utils.addScript("https://static.klaviyo.com/onsite/js/klaviyo.js?company_id="+this.publicToken,{id:"cvg-klaviyo-"+this.publicToken,onLoad:function(){t.isIdentified().then((function(e){e&&t.logEvent({forwardedEventName:"__activity__",method:"load-script"})}))}})},e.prototype.track=function(t,e){var r=this;window.klaviyo=window.klaviyo||[];var i=n(n({$event_id:"".concat(this.eventID,"::client")},e),{connection:"browser"});window.klaviyo.push(["track",t,i]),this.isIdentified().then((function(e){e&&r.logEvent({forwardedEventName:t,forwardedProperties:i,method:"track"})}))},e.prototype.parseLineItem=function(t){return{$value:t.price*t.quantity,AddedItemProductName:t.name,AddedItemVariantName:t.variant_name,AddedItemProductID:t.product_id,AddedItemVariantID:t.variant_id,AddedItemSKU:t.sku,AddedItemPrice:t.price,AddedItemCurrency:t.currency,AddedItemQuantity:t.quantity,AddedItemBrand:t.vendor,AddedItemURL:t.url,AddedItemImageURL:t.image_url}},e.prototype.parseProduct=function(t){return{ProductName:t.name,VariantName:t.variant_name,ProductID:t.product_id,VariantID:t.variant_id,SKU:t.sku,Brand:t.vendor,Price:t.price,Currency:t.currency,URL:t.url,ImageURL:t.image_url}},e.prototype.parseCheckout=function(t){return{$value:t.total_price,Currency:t.currency,ItemNames:t.items.map((function(t){return t.name})),Items:t.items.map((function(t){return{ProductID:t.product_id,VariantID:t.variant_id,SKU:t.sku,ProductName:t.name,VariantName:t.variant_name,Quantity:t.quantity,ItemPrice:t.price,RowTotal:t.price*t.quantity,Currency:t.currency,Brand:t.vendor,URL:t.url,ImageURL:t.image_url}}))}},e}(D),ft=function(t){switch(t.app){case"fb":return L;case"google_ads":return it;case"pinterest":return nt;case"ga4":return st;case"tiktok":return at;case"criteo":return ct;case"twitter":return ut;case"custom_html":return et;case"convert":return dt;case"bing":return ht;case"klaviyo":return lt}},vt=function(t){function e(r){var i=t.call(this,r)||this;return i.name="ExceededRateLimitError",Object.setPrototypeOf(i,e.prototype),i}return i(e,t),e}(Error),mt=function(){function t(t,e){this.MAX_QUEUE_SIZE=1e3,this.queue=[],this.capacity=t,this.rate=e,this.tokens=t,this.run()}return t.prototype.acquireToken=function(){return o(this,void 0,void 0,(function(){var t=this;return s(this,(function(e){return 0===this.queue.length&&this.tokens>0?(this.tokens-=1,[2]):[2,new Promise((function(e,r){t.queue.length<t.MAX_QUEUE_SIZE?t.queue.push((function(){t.tokens-=1,e(void 0)})):r(new vt("Leaky bucket queue is full"))}))]}))}))},t.prototype.run=function(){return o(this,void 0,void 0,(function(){var t,e=this;return s(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(t){return setTimeout(t,1e3/e.rate)}))];case 1:return r.sent(),this.tokens<this.capacity&&(this.tokens+=1,(t=this.queue.shift())&&t()),[3,0];case 2:return[2]}}))}))},t}(),yt=function(){function t(t,e,r){this.utils=t,this.browser=e,this.profileProperties={},this.eventProperties={},this.aliases=[],this.queue=[],this.logger=r}return t.prototype.init=function(t){this.uid=t,this.cookieUrn="urn:cookie:".concat(t),this.addAlias(this.cookieUrn),this.setDefaultProfileProperties(),this.setDefaultEventProperties()},t.prototype.setProperty=function(t,e){this.profileProperties[t]=e},t.prototype.setProperties=function(t){this.profileProperties=n(n({},this.profileProperties),t)},t.prototype.setEventProperty=function(t,e){this.eventProperties[t]=e},t.prototype.setEventProperties=function(t){this.eventProperties=n(n({},this.eventProperties),t)},t.prototype.addAlias=function(t){-1===this.aliases.indexOf(t)&&this.aliases.push(t)},t.prototype.track=function(t){this.handler?this.handler(t):this.queue.push(t)},t.prototype.forward=function(t){this.handler?this.handler(t):this.queue.push(t)},t.prototype.setHandler=function(t){this.handler=t,this.queue.forEach((function(e){return t(e)})),this.queue=[]},t.prototype.setDefaultProfileProperties=function(){this.setProperties({$version:2,$user_agent:this.browser.navigator.userAgent,$screen_resolution:this.browser.screen_resolution,$is_mobile:this.utils.isMobile(),$timezone:this.browser.timeZone,$language:this.browser.navigator.language,$cookie_id:this.uid,cookie_id:this.uid})},t.prototype.setDefaultEventProperties=function(){this.setEventProperties({$url:this.browser.window.location.href,$referrer:this.browser.document.referrer,$title:this.browser.document.title,referrer:this.browser.document.referrer})},t}(),gt=function(){function t(t,e,r,i,n,o){var s=this;this.rateLimiter=new mt(5,5),this.browser=t,this.utils=e,this.logger=r,this.publicToken=o.publicToken,this.includeIpAddress=void 0===o.includeIpAddress||o.includeIpAddress,this.pixelInterface=i,this.integrations=n,this.connectionConfigs=o.connections||[],this.pixelInterface.setHandler((function(t){return s.process.bind(s)(t)}))}return t.create=function(e,r){return o(this,void 0,void 0,(function(){var i,n,o,c,u,d,h,v,g,_,T,N,A;return s(this,(function(s){switch(s.label){case 0:return r=r||new S,i=new p(r),n=new q(e.logLevel),i.detectBot()?(n.info("Detected bot, not setting up Converge"),[2]):[4,i.detectInternalUser()];case 1:return s.sent()?(n.info("Detected internal user, not setting up Converge"),[2]):(o=e.publicToken,c=new yt(i,r,n),[4,i.setUid()]);case 2:u=s.sent(),c.init(u);try{for(d=a(e.connections||[]),h=d.next();!h.done;h=d.next())if(v=h.value,g=ft(v.config)){_={browser:r,utils:i,logger:n,connection_id:v.connection_id,config:v.config,publicToken:o,connectionEventLogger:new $({logger:n,config:v,publicToken:o,cookieUrn:c.cookieUrn}),pixel:c};try{g.setup(_)}catch(t){n.error("Error setting up connection",_,t),_t(t,r,o)}}}catch(t){N={error:t}}finally{try{h&&!h.done&&(A=d.return)&&A.call(d)}finally{if(N)throw N.error}}return D=c,O=e.integrationConfig,T={facebook:f.create(D,O),klaviyo:y.create(D,O),tiktok:k.create(D,O),criteo:l.create(D,O),ga4:m.create(D,O),shopify:w.create(D,O),utm:b.create(D,O),adBlocker:I.create(D,O),pinterest:C.create(D,O),taboola:P.create(D,O),outbrain:x.create(D,O),funnelish:E.create(D,O)},[4,Promise.all(Object.values(T).map((function(t){return null==t?void 0:t.setup()})))];case 3:return s.sent(),[2,new t(r,i,n,c,T,e)]}var D,O}))}))},t.prototype.process=function(t){return o(this,void 0,void 0,(function(){var e,r,i,o,c;return s(this,(function(s){switch(s.label){case 0:switch(t.method){case"track":return[3,1];case"forward":return[3,4];case"set":return[3,6];case"event":return[3,7];case"link_domain":return[3,10];case"cvg_uid":return[3,11];case"init":return[3,12]}return[3,13];case 1:return[4,this.rateLimiter.acquireToken()];case 2:return s.sent(),[4,this.track(t)];case 3:return[2,s.sent()];case 4:return[4,this.rateLimiter.acquireToken()];case 5:return s.sent(),[2,this.forward(t)];case 6:t.alias&&this.pixelInterface.addAlias(t.alias);try{for(e=a(t.aliases||[]),r=e.next();!r.done;r=e.next())i=r.value,this.pixelInterface.addAlias(i)}catch(t){o={error:t}}finally{try{r&&!r.done&&(c=e.return)&&c.call(e)}finally{if(o)throw o.error}}return t.properties&&this.pixelInterface.setProperties(t.properties),t.eventProperties&&this.pixelInterface.setEventProperties(t.eventProperties),[2];case 7:return[4,this.rateLimiter.acquireToken()];case 8:return s.sent(),[4,this.track(n(n({},t),{method:"track",eventName:t.event,eventID:t.eventId}))];case 9:return[2,s.sent()];case 10:return[2,this.linkDomain(t.domain)];case 11:t.resolve&&t.resolve(this.pixelInterface.uid||""),s.label=12;case 12:return[2];case 13:return this.logger.error("Invalid method",t),[2]}}))}))},t.prototype.registerParameters=function(t,e){var r,i;if(e)try{for(var n=a(e),o=n.next();!o.done;o=n.next()){var s=o.value;this.pixelInterface.addAlias(s)}}catch(t){r={error:t}}finally{try{o&&!o.done&&(i=n.return)&&i.call(n)}finally{if(r)throw r.error}}if(t)for(var c in t)this.pixelInterface.setProperty(c,t[c])},t.prototype.track=function(t){return o(this,void 0,void 0,(function(){var e,r,i,o,a,c,u,d,p,h,l,f,v,m,y;return s(this,(function(s){switch(s.label){case 0:return this.publicToken?(e=t.eventName,r=t.eventID,i=t.aliases,o=t.properties,a=t.profileProperties,c=t.resolve,u=t.reject,this.registerParameters(a,i),d=n(n(n({},this.pixelInterface.profileProperties),this.pixelInterface.eventProperties),o),(p=r)||(p=this.utils.guid()),h=JSON.stringify({event_name:e,distinct_id:this.pixelInterface.aliases,event_id:p,properties:d,include_ip_address:this.includeIpAddress,profile_properties:this.pixelInterface.profileProperties}),l=fetch("".concat(T,"/api/tr/track?public_token=").concat(this.publicToken),{method:"post",headers:{"Content-Type":"application/json"},body:h,keepalive:!0}),this.forward({method:"forward",eventName:e,properties:d,profileProperties:this.pixelInterface.profileProperties,eventID:p}),[4,l]):(this.logger.error("Converge pixel not initialized, skipping track",t),[2]);case 1:return 200===(f=s.sent()).status?[3,3]:[4,f.text()];case 2:m=s.sent(),v=new Error("Failed to send fetch ".concat(m)),s.label=3;case 3:return[4,f.text()];case 4:if("1"!==(y=s.sent())&&(v=new Error("Failed to track event response is ".concat(y))),v)throw u&&u(v),this.logger.error("Could not track event",v),v;return c&&c(y),[2]}}))}))},t.prototype.forward=function(t){var e=this;this.registerParameters(t.profileProperties);var r=n(n({},t),{profileProperties:this.pixelInterface.profileProperties});this.connectionConfigs.forEach((function(t){try{var i=ft(t.config);if(!i)return;new i({browser:e.browser,utils:e.utils,logger:e.logger,connection_id:t.connection_id,config:t.config,publicToken:e.publicToken,connectionEventLogger:new $({logger:e.logger,config:t,publicToken:e.publicToken,cookieUrn:e.pixelInterface.cookieUrn}),pixel:e.pixelInterface},r).forward()}catch(t){e.logger.error("Error forwarding to connection",t),e.handleError(t)}}))},t.prototype.handleError=function(t){return o(this,void 0,void 0,(function(){return s(this,(function(e){return this.logger.error("Unhandled error",t),_t(t,this.browser,this.publicToken),[2]}))}))},t.prototype.linkDomain=function(t){var e=this;document.addEventListener("click",(function(r){var i,n=null===(i=r.target)||void 0===i?void 0:i.closest("a");if(n&&-1!==n.href.indexOf(t)){var o=-1===n.href.indexOf("?")?"?":"&";n.href+="".concat(o).concat(e.utils.UID_COOKIE,"=").concat(e.pixelInterface.uid)}}))},t.prototype.getCookieId=function(){return this.pixelInterface.uid},t}(),_t=function(t,e,r){return o(void 0,void 0,void 0,(function(){var i;return s(this,(function(o){switch(o.label){case 0:if(t instanceof vt)return[2];i={url:null==e?void 0:e.window.location.href,referrer:null==e?void 0:e.document.referrer,public_token:r,user_agent:null==e?void 0:e.navigator.userAgent},t instanceof Error&&(i=n(n({},i),{error:t.toString(),error_name:t.name,error_message:t.message,error_filename:t.filename,error_lineno:t.lineno,error_colno:t.colno,error_stack:t.stack})),o.label=1;case 1:return o.trys.push([1,3,,4]),[4,fetch("".concat(T,"/api/tr/error"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i),keepalive:!0})];case 2:case 3:return o.sent(),[3,4];case 4:return[2]}}))}))},wt=function(){var t=this;if(this.preInitQueue=[],this.process=function(e){return o(t,void 0,void 0,(function(){var t,r,i;return s(this,(function(n){switch(n.label){case 0:return n.trys.push([0,8,,9]),this.handler?[4,this.handler(e)]:[3,2];case 1:return n.sent(),[3,7];case 2:return"init"!==e.method?[3,4]:[4,this.init(e)];case 3:return n.sent(),[3,7];case 4:return"consent"!==e.method?[3,6]:[4,this.consent(e)];case 5:return n.sent(),[3,7];case 6:this.preInitQueue.push(e),n.label=7;case 7:return[3,9];case 8:return t=n.sent(),_t(t,null===(r=this.pixel)||void 0===r?void 0:r.browser,null===(i=this.initArgs)||void 0===i?void 0:i.publicToken),[3,9];case 9:return[2]}}))}))},this.init=function(e){return o(t,void 0,void 0,(function(){var t;return s(this,(function(r){switch(r.label){case 0:return this.initArgs?[2]:(this.initArgs=e,this.hasConsent=this.hasConsent||null===(t=this.initArgs.consent)||void 0===t||t,this.hasConsent?[4,this.setup()]:[2]);case 1:return r.sent(),[2]}}))}))},this.consent=function(e){return o(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return this.hasConsent===e.consent?[2]:(this.hasConsent=e.consent,this.hasConsent?[4,this.setup()]:[3,2]);case 1:return t.sent(),[3,3];case 2:this.pixel=void 0,this.handler=void 0,t.label=3;case 3:return[2]}}))}))},this.setup=function(){return o(t,void 0,void 0,(function(){var t,e=this;return s(this,(function(r){switch(r.label){case 0:return!this.initArgs||this.pixel?[2]:(t=this,[4,gt.create(this.initArgs)]);case 1:return t.pixel=r.sent(),this.handler=function(t){return o(e,void 0,void 0,(function(){var e;return s(this,(function(r){switch(r.label){case 0:return[4,null===(e=this.pixel)||void 0===e?void 0:e.process.bind(this.pixel)(t)];case 1:return r.sent(),[2]}}))}))},this.emptyQueue(),[2]}}))}))},this.emptyQueue=function(){var e,r;if(t.handler){try{for(var i=a(t.preInitQueue),n=i.next();!n.done;n=i.next()){var o=n.value;t.handler(o)}}catch(t){e={error:t}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(e)throw e.error}}t.preInitQueue=[]}},this.hasConsent=!1,window.cvg)for(window.cvg.process=function(e){return o(t,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.process.bind(this)(e)];case 1:return t.sent(),[2]}}))}))};window.cvg.queue&&window.cvg.queue.length;){var e=window.cvg.queue.shift();if(!e)break;this.process(e[0])}else window.cvg=function(e){return t.process(e)}};t.convergeProcessor=void 0;try{t.convergeProcessor=new wt,window.__cvg_pixel&&window.__cvg_pixel.public_token&&window.cvg&&window.cvg({method:"init",publicToken:window.__cvg_pixel.public_token,integrationConfig:window.__cvg_pixel.integration_config||{},connections:window.__cvg_pixel.connections||[],includeIpAddress:window.__cvg_pixel.include_ip_address,builtAt:window.__cvg_pixel.built_at})}catch(t){_t(t,void 0,null===(Y=window.__cvg_pixel)||void 0===Y?void 0:Y.public_token)}}({});
//# sourceMappingURL=main.js.map
